---
layout: default
title: API checkup
---
<h1>[[title]]</h1>

<p>Cette page permet de visualiser la disponibilité des services exposés par l'API</p>

<div id="statuses"></div>

<script type="text/jsx">
    var routes = [
        {name: "All", url: "/api/installations"},
        {name: "By id", url: "/api/installations/440030016"},
        {name: "Random", url: "/api/installations/random"},
        {name: "Stats", url: "/api/installations/stats"}
    ];

    var RouteStatusLine = React.createClass({
        getInitialState: function () {
            return {};
        },
        componentDidMount: function () {
            $.ajax({
                url: this.props.url,
                dataType: 'json',
                success: function (data) {
                    this.setState({status: "OK", statusClassName: "label label-success"});
                }.bind(this),
                error: function (xhr, status, err) {
                    this.setState({status: "KO", statusClassName: "label label-danger"});
                }.bind(this)
            });
        },
        render: function () {
            if (!this.state.status) {
                return (
                        <tr>
                            <td>
                                <b>{this.props.name}</b>
                            </td>
                            <td>
                                {this.props.url}
                            </td>
                            <td>
                                <span className="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
                            </td>
                        </tr>
                );
            }
            else {
                return (
                        <tr>
                            <td>
                                <b>{this.props.name}</b>
                            </td>
                            <td>
                                {this.props.url}</td>
                            <td>
                                <span className={this.state.statusClassName}>{this.state.status}</span>
                            </td>
                        </tr>
                );
            }
        }
    });

    var RouteStatusTable = React.createClass({
        render: function () {
            var routeStatusLines = this.props.routes.map(function (route) {
                return (
                        <RouteStatusLine name={route.name} url={route.url} />
                );
            });
            return (
                    <table className="table">
                        <thead>
                            <tr>
                                <th>Nom</th>
                                <th>Route</th>
                                <th>Statut</th>
                            </tr>
                        </thead>
                        <tbody>
                            {routeStatusLines}
                        </tbody>
                    </table>
            );
        }
    });

    React.render(
            <RouteStatusTable routes={routes} />,
            document.getElementById('statuses')
    );

</script>